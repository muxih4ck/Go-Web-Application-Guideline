## API 规范

[Go 自动生成 Swagger 文档的介绍](https://static.muxixyz.com/api.pdf)

API作为服务端和客户端协作的重要部分，应该遵守一系列的规范来减少协作时产生和意识到的问题。

## 设计API

在数据库设计完之后，进行API的设计，在API的设计过程中应当确定下几个子规范：

  + 名词规范
  + 状态码规范
  + 错误处理规范
错误处理和状态码规范在其他部分会详细讲，所以首先需要确立下所谓的名词规范。

**名词规范**

众所周知，URI中不应该出现动词，那就是说所有的API的具体的URI都应该使用名词来进行路径的描述，而在一套系统的API中，如果对同一个实体的描述产生了两种或者多种，则会引起撰写接口时的麻烦，而对于传入的参数和返回的数据中的变量名也应该使用统一的规范，否则会引起客户端代码的不协调，还会给开发客户端的开发人员带来很多麻烦，甚至会出现使用错误的情况。

上面的描述不是危言耸听，工程的开发不是一蹴而就的，往往需要几个人协作开发，而且还需要相当的一段时间，而每个开发人员的习惯都是不一样的。比如程序员A对于“生成”这个词喜欢使用generate，而程序员B喜欢使用new来进行表达。这就造成了同一个产品的代码中出现了两种指向同一个语义的表达方式。对于客户端工程师而言这也让他们头晕，在写代码时晕头转向，最后造成了错误，要花更久的时间来进行调试。

因此建议在进行API设计的同时出一份名词规范，就像一个字典一样，这样能够统一对于名词的使用规范（最好也囊括名词的复数形式）

对于一般的名词都应该使用全称而非缩写。

**关于命名**

一律使用驼峰命名法来进行命名，函数内的变量开头一律小写。对于JSON和GORM这种需要加注释的地方使用下划线命名法。

**避免冗余信息**

API在书写时是有上下文context的，所以有一些信息的冗余应当避免。比如在对于评论的资源的操作时，上下文可以明确的告诉我们ID应该是指的CommentID，所以在路径中没有必要指出是CommentID。
比如：

+ http://api.work.muxixyz.com/comments/:Cid X
+ http://api.work.muxixzy.com/comments/:id  √
+ http://api.work.muxixyz.com/organization/:OrgID/member/:MemberID √

也就是所有的可以推导出没有歧义的部分没有必要加额外信息加以说明。
